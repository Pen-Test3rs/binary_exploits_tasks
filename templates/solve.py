from pwn import *
# https://docs.pwntools.com/en/stable/index.html

elf = context.binary = ELF("./task") # path to local binary

# python solve.py
# python solve.py GDB
# python solve.py REMOTE

if args.GDB:
	p = gdb.debug(elf.path) # runs program under gdb, second parameter is script for gdb
	# p = gdb.debug(elf.path, '\n'.join([  # runs program under gdb, second parameter is script for gdb
	# 	"b *main",
	# 	"c"
	# ]))
elif args.REMOTE:
	p = remote("addr", 0)  # ip (or hostname), port
else:
	p = process(elf.path) 

# https://docs.pwntools.com/en/stable/tubes.html
# p.sendline("ls")  	# sends line to the binary
# p.recvline()  		# receive line from binary
# print(p.clean()) 		# receive all and print

# https://docs.pwntools.com/en/stable/util/packing.html
# p64(0x1337)  # packs number as 64bit integer (default: little endian)
# p32, u64, u32


p.interactive() # enable interaction
