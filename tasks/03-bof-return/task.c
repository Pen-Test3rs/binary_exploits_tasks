#include <stdlib.h>
#include <stdio.h>
#include <string.h>

void init_visualize(char *buff);
void visualize(char *buff);

void print_flag()
{
    FILE *f = fopen("./flag.txt", "rt");
    if (f == NULL)
        return;

    char flag[64];
    fread(flag, sizeof(char), sizeof(flag), f);
    fclose(f);

    puts("Excellent! Here is the flag:");
    puts(flag);
}

void vuln()
{
    puts("Return address overflow:");
    puts("---------------");

    char buffer[32];
    memset(buffer, 0, sizeof(buffer));
    init_visualize(buffer);

    printf("Here is current stack: ");
    visualize(buffer);
    printf("Return address: %p\n", __builtin_return_address(0));

    gets(buffer);
}

int main(int argc, char *argv[])
{
    setvbuf(stdout, NULL, _IONBF, 0);
    setvbuf(stdin, NULL, _IONBF, 0);

    vuln();

    return 0;
}
